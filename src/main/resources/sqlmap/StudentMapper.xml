<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="springmvc.dao.StudentMapper">
  <resultMap id="BaseResultMap" type="springmvc.entity.Student">
    <id column="s_id" jdbcType="INTEGER" property="sId" />
    <result column="s_name" jdbcType="VARCHAR" property="sName" />
    <result column="s_password" jdbcType="VARCHAR" property="sPassword" />
    <result column="s_sex" jdbcType="VARCHAR" property="sSex" />
    <result column="s_age" jdbcType="INTEGER" property="sAge" />
    <result column="s_num" jdbcType="VARCHAR" property="sNum" />
    <result column="s_tel" jdbcType="INTEGER" property="sTel" />
    <result column="s_address" jdbcType="VARCHAR" property="sAddress" />
    <result column="s_birthday" jdbcType="DATE" property="sBirthday" />
    <result column="s_mail" jdbcType="VARCHAR" property="sMail" />
    <result column="s_captcha" jdbcType="VARCHAR" property="sCaptcha" />
    <collection property="scoreList" ofType="score">
      <id column="id" jdbcType="INTEGER" property="id" />
      <result column="sid" jdbcType="INTEGER" property="sid" />
      <result column="cid" jdbcType="INTEGER" property="cid" />
      <result column="score" jdbcType="REAL" property="score" />
      <association property="course" javaType="Course">
        <id column="c_id" jdbcType="INTEGER" property="cId" />
        <result column="c_name" jdbcType="VARCHAR" property="cName" />
        <result column="c_tid" jdbcType="INTEGER" property="cTid" />
        <association property="teacher" javaType="teacher">
          <id property="teacherId" column="t_id"/>
          <result column="t_name" jdbcType="VARCHAR" property="tName" />
          <result column="t_password" jdbcType="VARCHAR" property="tPassword" />
          <result column="t_sex" jdbcType="VARCHAR" property="tSex" />
          <result column="t_age" jdbcType="INTEGER" property="tAge" />
          <result column="t_num" jdbcType="VARCHAR" property="tNum" />
          <result column="t_tel" jdbcType="INTEGER" property="tTel" />
          <result column="t_address" jdbcType="VARCHAR" property="tAddress" />
          <result column="t_birthday" jdbcType="DATE" property="tBirthday" />
          <result column="t_mail" jdbcType="VARCHAR" property="tMail" />
          <result column="t_captcha" jdbcType="VARCHAR" property="tCaptcha" />
        </association>
      </association>
    </collection>
  </resultMap>
  <sql id="Base_Column_List">
    s_id, s_name, s_password, s_sex, s_age, s_num, s_tel, s_address, s_birthday, s_mail,
    s_captcha
  </sql>
  <select id="selectByPrimaryKey" parameterType="java.lang.Integer" resultMap="BaseResultMap">
    select 
    s_id, s_name, s_password, s_sex, s_age, s_num, s_tel, s_address, s_birthday, s_mail,
    s_captcha
    from student
    where s_id = #{sId,jdbcType=INTEGER}
  </select>
  <delete id="deleteByPrimaryKey" parameterType="java.lang.Integer">
    delete from student
    where s_id = #{sId,jdbcType=INTEGER}
  </delete>
  <insert id="insert" parameterType="springmvc.entity.Student">
    insert into student (s_id, s_name, s_password, 
      s_sex, s_age, s_num, s_tel, 
      s_address, s_birthday, s_mail, 
      s_captcha)
    values (#{sId,jdbcType=INTEGER}, #{sName,jdbcType=VARCHAR}, #{sPassword,jdbcType=VARCHAR}, 
      #{sSex,jdbcType=VARCHAR}, #{sAge,jdbcType=INTEGER}, #{sNum,jdbcType=VARCHAR}, #{sTel,jdbcType=INTEGER}, 
      #{sAddress,jdbcType=VARCHAR}, #{sBirthday,jdbcType=DATE}, #{sMail,jdbcType=VARCHAR}, 
      #{sCaptcha,jdbcType=VARCHAR})
  </insert>
  <insert id="insertSelective" parameterType="springmvc.entity.Student">
    insert into student
    <trim prefix="(" suffix=")" suffixOverrides=",">
      <if test="sId != null">
        s_id,
      </if>
      <if test="sName != null">
        s_name,
      </if>
      <if test="sPassword != null">
        s_password,
      </if>
      <if test="sSex != null">
        s_sex,
      </if>
      <if test="sAge != null">
        s_age,
      </if>
      <if test="sNum != null">
        s_num,
      </if>
      <if test="sTel != null">
        s_tel,
      </if>
      <if test="sAddress != null">
        s_address,
      </if>
      <if test="sBirthday != null">
        s_birthday,
      </if>
      <if test="sMail != null">
        s_mail,
      </if>
      <if test="sCaptcha != null">
        s_captcha,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides=",">
      <if test="sId != null">
        #{sId,jdbcType=INTEGER},
      </if>
      <if test="sName != null">
        #{sName,jdbcType=VARCHAR},
      </if>
      <if test="sPassword != null">
        #{sPassword,jdbcType=VARCHAR},
      </if>
      <if test="sSex != null">
        #{sSex,jdbcType=VARCHAR},
      </if>
      <if test="sAge != null">
        #{sAge,jdbcType=INTEGER},
      </if>
      <if test="sNum != null">
        #{sNum,jdbcType=VARCHAR},
      </if>
      <if test="sTel != null">
        #{sTel,jdbcType=INTEGER},
      </if>
      <if test="sAddress != null">
        #{sAddress,jdbcType=VARCHAR},
      </if>
      <if test="sBirthday != null">
        #{sBirthday,jdbcType=DATE},
      </if>
      <if test="sMail != null">
        #{sMail,jdbcType=VARCHAR},
      </if>
      <if test="sCaptcha != null">
        #{sCaptcha,jdbcType=VARCHAR},
      </if>
    </trim>
  </insert>
  <update id="updateByPrimaryKeySelective" parameterType="springmvc.entity.Student">
    update student
    <set>
      <if test="sName != null">
        s_name = #{sName,jdbcType=VARCHAR},
      </if>
      <if test="sPassword != null">
        s_password = #{sPassword,jdbcType=VARCHAR},
      </if>
      <if test="sSex != null">
        s_sex = #{sSex,jdbcType=VARCHAR},
      </if>
      <if test="sAge != null">
        s_age = #{sAge,jdbcType=INTEGER},
      </if>
      <if test="sNum != null">
        s_num = #{sNum,jdbcType=VARCHAR},
      </if>
      <if test="sTel != null">
        s_tel = #{sTel,jdbcType=INTEGER},
      </if>
      <if test="sAddress != null">
        s_address = #{sAddress,jdbcType=VARCHAR},
      </if>
      <if test="sBirthday != null">
        s_birthday = #{sBirthday,jdbcType=DATE},
      </if>
      <if test="sMail != null">
        s_mail = #{sMail,jdbcType=VARCHAR},
      </if>
      <if test="sCaptcha != null">
        s_captcha = #{sCaptcha,jdbcType=VARCHAR},
      </if>
    </set>
    where s_id = #{sId,jdbcType=INTEGER}
  </update>
  <update id="updateByPrimaryKey" parameterType="springmvc.entity.Student">
    update student
    set s_name = #{sName,jdbcType=VARCHAR},
      s_password = #{sPassword,jdbcType=VARCHAR},
      s_sex = #{sSex,jdbcType=VARCHAR},
      s_age = #{sAge,jdbcType=INTEGER},
      s_num = #{sNum,jdbcType=VARCHAR},
      s_tel = #{sTel,jdbcType=INTEGER},
      s_address = #{sAddress,jdbcType=VARCHAR},
      s_birthday = #{sBirthday,jdbcType=DATE},
      s_mail = #{sMail,jdbcType=VARCHAR}
    where s_id = #{sId,jdbcType=INTEGER}
  </update>


    <select id="getStudentTotal" resultType="java.lang.Integer">
    select count(*) from student
  </select>

    <select id="studentList" resultMap="BaseResultMap">
        SELECT * FROM student ORDER BY s_id desc limit #{param1}, #{param2}
    </select>

  <select id="selectByStudent" parameterType="java.lang.Integer" resultType="java.util.HashMap">
    select
    student.s_id as sId,student.s_name as sName,course.c_id as cId,
    course.c_name as cName,teacher.t_id as tId,teacher.t_name as tName
    from student,course,score,teacher
    where student.s_id = #{sId,jdbcType=INTEGER} and
    student.s_id = score.sid and score.cid = course.c_id
    and course.c_tid = teacher.t_id
  </select>

  <select id="selectScoreByStudent" parameterType="java.lang.Integer" resultType="java.util.HashMap">
    select
    student.s_id as sId,student.s_name as sName,course.c_id as cId,
    course.c_name as cName, score.score as score,score.id as id
    from student,course,score
    where student.s_id = #{sId,jdbcType=INTEGER} and
    student.s_id = score.sid and score.cid = course.c_id
  </select>

  <select id="selectStudentByMail" parameterType="java.lang.String" resultMap="BaseResultMap">
    select
    <include refid="Base_Column_List" />
    from student
    where s_mail = #{sMail,jdbcType=VARCHAR}
  </select>
</mapper>